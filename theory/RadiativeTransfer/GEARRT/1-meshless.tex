%======================================================
\section{Meshless Methods: Essentials}
%======================================================

The Meshless methods are a way to solve hyperbolic systems of conservation laws of the form
\begin{equation}
    \DELDT{\mathcal{U}} + \nabla \mathcal{F}(\mathcal{U}) = 0 \label{eq:conservation-law}
\end{equation}

and are used to solve the hydrodynamics equations.
Since the M1 RT method can be written in the same form, the method will also be 
used to solve these equations. For completeness, the most important formulae are 
listed below. For the actual implementation details, please refer to the `Gizmo'
theory section in the SWIFT repository, and \cite{hopkinsGIZMONewClass2015}.



The meshless schemes rely on the ``partitions of unity''. 
The partition of unity assigned to a particle $i$ is defined as:

\begin{align}
	\psi_i(\x) &= \frac{1}{\omega(\x)} W(\x - \x_i, h(\x))		\label{eq:psi} \\
	\omega(\x) &= \sum_j W(\x - \x_j, h(\x)) 					\label{eq:omega}
\end{align}

where $h(\x)$ is the smoothing length and $\omega(\x)$ is used to normalise the 
volume partition at any point $\x$. 

The particle ``volumes'' are given by

\begin{align}
	V_i &= \int_V \psi_i(\x) \de V \approx \frac{1}{\omega(\x_i)} \label{psi_volume_integral}
\end{align}


The actual state updates are given by

\begin{equation}
	\frac{\D}{\D t} (V_i \mathcal{U}_{k,i}) + \sum_j \mathcal{F}_{k,ij} \cdot \Aijm = 0
\end{equation}


with

\begin{equation}
	\Aijm^\alpha = V_i \psitilde_j^\alpha (\x_i) - V_j\psitilde_i^\alpha (\x_j) 			\label{eq:HopkinsAij}
\end{equation}

for every component $k$ of the state vector $\mathcal{U}$ and for every coordinate dimension
$\alpha$.

The $\psitilde(\x)$ come from the $\mathcal{O}(h^2)$ accurate discrete gradient expression from \cite{lansonRenormalizedMeshfreeSchemes2008}:

\begin{align}
	\frac{\del}{\del x_{\alpha}} f(\x) \big{|}_{\x_i} &= 
	\sum_j \left( f(\x_j) - f(\x_i) \right) \psitilde_j^\alpha (\x_i) 		\label{eq:gradient} \\
	\psitilde_j^\alpha (\x_i) &= \sum_{\beta = 1}^{\beta=\nu} \mathbf{B}_i^{\alpha \beta} 
	(\x_j - \x_i)^\beta \psi_j(\x_i) 	\\
	\mathbf{B}_i &= \mathbf{E_i} ^ {-1} \\ 
	\mathbf{E}_i^{\alpha \beta} &= \sum_j (\x_j - \x_i)^\alpha (\x_j - \x_i)^\beta \psi_j(\x_i)
\end{align}


where $\alpha$ and $\beta$ again represent the coordinate components for $\nu$ dimensions.
